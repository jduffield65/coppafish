Number of Calls,Time / Seconds,Time Per Call / Seconds,Function
1,79738.299,79738.299,{built-in method builtins.exec}
1,79738.299,79738.299,/Applications/PyCharm.app/Contents/plugins/python/helpers/profiler/prof_util.py:14(execfile)
1,79738.28,79738.28,/Users/joshduffield/Documents/UCL/ISS/Python/ISS/main.py:1(<module>)
1,79736.607,79736.607,coppafish/pipeline/run.py:14(run_pipeline)
1,75224.02,75224.02,coppafish/pipeline/run.py:240(run_omp)
1,75215.259,75215.259,coppafish/pipeline/omp.py:20(call_spots_omp)
661,66176.089,100.115,coppafish/utils/morphology/filter.py:73(imfilter_coords)
661,66056.835,99.935,coppafish/utils/morphology/filter.py:9(imfilter)
661,66056.803,99.935,python3.9/site-packages/scipy/ndimage/_filters.py:693(correlate)
661,66056.799,99.935,python3.9/site-packages/scipy/ndimage/_filters.py:640(_correlate_or_convolve)
661,66056.744,99.935,{built-in method scipy.ndimage._nd_image.correlate}
5,65536.326,13107.265,coppafish/omp/spots.py:256(get_spots)
365,64479.368,176.656,coppafish/omp/spots.py:12(count_spot_neighbours)
209,4947.474,23.672,coppafish/spot_colors/base.py:54(get_spot_colors)
196,4202.781,21.443,coppafish/omp/coefs.py:233(get_all_coefs)
1,3711.361,3711.361,coppafish/pipeline/run.py:103(run_find_spots)
1,3710.538,3710.538,coppafish/pipeline/find_spots.py:8(find_spots)
10242,3144.383,0.307,coppafish/spot_colors/base.py:8(apply_transform)
492,3000.834,6.099,coppafish/find_spots/detect.py:7(detect_spots)
0,2678.693,0,{built-in method numpy.core._multiarray_umath.implement_array_function}
1926,2197.228,1.141,coppafish/omp/coefs.py:8(fit_coefs)
492,2005.017,4.075,coppafish/utils/morphology/base.py:171(dilate)
492,2004.998,4.075,python3.9/site-packages/scipy/ndimage/_morphology.py:1224(grey_dilation)
492,2004.984,4.075,python3.9/site-packages/scipy/ndimage/_filters.py:1080(_min_or_max_filter)
1476,2004.936,1.358,python3.9/site-packages/scipy/ndimage/_filters.py:1023(maximum_filter1d)
1476,2004.909,1.358,{built-in method scipy.ndimage._nd_image.min_or_max_filter1d}
4,1783.689,445.922,coppafish/find_spots/base.py:36(get_isolated)
0,1604.769,0,<__array_function__ internals>:177(lstsq)
0,1507.37,0,python3.9/site-packages/numpy/linalg/linalg.py:2165(lstsq)
196,1176.988,6.005,coppafish/omp/coefs.py:120(get_best_gene_first_iter)
2122,1139.26,0.537,coppafish/omp/coefs.py:77(get_best_gene_base)
2131,1016.67,0.477,coppafish/call_spots/dot_product.py:6(dot_product_score)
10427,938.4,0.09,coppafish/utils/npy.py:68(load_tile)
0,863.3,0,{method 'reduce' of 'numpy.ufunc' objects}
10381,778.558,0.075,python3.9/site-packages/numpy/core/memmap.py:333(__getitem__)
22784,615.18,0.027,{method 'all' of 'numpy.ndarray' objects}
22781,615.088,0.027,python3.9/site-packages/numpy/core/_methods.py:60(_all)
197,415.573,2.11,coppafish/call_spots/background.py:6(fit_background)
56384,394.687,0.007,python3.9/site-packages/scipy/spatial/_kdtree.py:346(query)
56376,394.634,0.007,{function KDTree.query at 0x11a131dc0}
31,391.471,12.628,coppafish/stitch/shift.py:318(compute_shift)
1,370.943,370.943,coppafish/pipeline/run.py:158(run_register)
1,349.132,349.132,coppafish/pipeline/register_initial.py:9(register_initial)
11861,272.797,0.023,<__array_function__ internals>:177(pad)
11856,272.677,0.023,python3.9/site-packages/numpy/lib/arraypad.py:529(pad)
11718,246.071,0.021,python3.9/site-packages/numpy/lib/arraypad.py:86(_pad_simple)
1929,243.085,0.126,coppafish/omp/coefs.py:168(get_best_gene)
0,242.741,0,{method 'astype' of 'numpy.ndarray' objects}
1,236.152,236.152,coppafish/pipeline/run.py:193(run_reference_spots)
93,232.966,2.505,coppafish/stitch/shift.py:133(get_best_shift_3d)
1,229.562,229.562,coppafish/omp/spots.py:119(spot_neighbourhood)
1153,221.285,0.192,<__array_function__ internals>:177(where)
107786,215.573,0.002,python3.9/site-packages/numpy/core/fromnumeric.py:69(_wrapreduction)
0,208.166,0,python3.9/site-packages/numpy/linalg/linalg.py:136(_commonType)
200,199.65,0.998,{method 'uniform' of 'numpy.random._generator.Generator' objects}
1,199.274,199.274,coppafish/pipeline/get_reference_spots.py:12(get_reference_spots)
2061,197.838,0.096,python3.9/site-packages/scipy/sparse/_compressed.py:26(__init__)
1032,197.153,0.191,python3.9/site-packages/scipy/sparse/_coo.py:126(__init__)
479,196.025,0.409,{method 'nonzero' of 'numpy.ndarray' objects}
1,194.043,194.043,coppafish/pipeline/run.py:124(run_stitch)
10570,158.547,0.015,python3.9/site-packages/numpy/lib/npyio.py:254(load)
40,158.252,3.956,coppafish/stitch/shift.py:179(get_best_shift_2d)
2,150.11,75.055,coppafish/utils/npy.py:176(save_stitched)
15,143.768,9.585,<__array_function__ internals>:177(savez_compressed)
15,143.767,9.584,python3.9/site-packages/numpy/lib/npyio.py:603(savez_compressed)
15,143.767,9.584,python3.9/site-packages/numpy/lib/npyio.py:669(_savez)
2280,143.654,0.063,python3.9/site-packages/numpy/lib/format.py:625(write_array)
4774,143.206,0.03,python3.9/zipfile.py:1122(write)
4756,142.688,0.03,{method 'compress' of 'zlib.Compress' objects}
200,139.756,0.699,coppafish/call_spots/qual_check.py:6(get_spot_intensity)
10293,133.815,0.013,python3.9/site-packages/numpy/lib/format.py:790(open_memmap)
65769,131.538,0.002,<__array_function__ internals>:177(sum)
65736,131.473,0.002,python3.9/site-packages/numpy/core/fromnumeric.py:2162(sum)
10053,130.693,0.013,python3.9/site-packages/numpy/core/memmap.py:208(__new__)
0,125.194,0,python3.9/site-packages/numpy/core/fromnumeric.py:51(_wrapfunc)
0,89.052,0,python3.9/site-packages/numpy/linalg/linalg.py:112(_makearray)
27501,82.502,0.003,<__array_function__ internals>:177(round_)
27466,82.398,0.003,python3.9/site-packages/numpy/core/fromnumeric.py:3722(round_)
27457,82.371,0.003,<__array_function__ internals>:177(around)
27439,82.317,0.003,python3.9/site-packages/numpy/core/fromnumeric.py:3214(around)
27401,82.202,0.003,{method 'round' of 'numpy.ndarray' objects}
1074,81.631,0.076,python3.9/site-packages/scipy/sparse/_index.py:46(__getitem__)
76239,76.239,0.001,<__array_function__ internals>:177(amax)
76201,76.201,0.001,python3.9/site-packages/numpy/core/fromnumeric.py:2677(amax)
1075,75.254,0.07,python3.9/site-packages/scipy/sparse/_compressed.py:798(_get_submatrix)
438,75.252,0.172,python3.9/site-packages/scipy/sparse/_csr.py:315(_get_sliceXint)
437,75.204,0.172,{built-in method scipy.sparse._sparsetools.get_csr_submatrix}
1787,64.336,0.036,python3.9/site-packages/numpy/lib/function_base.py:3674(_ureduce)
1782,64.14,0.036,<__array_function__ internals>:177(median)
1782,64.138,0.036,python3.9/site-packages/numpy/lib/function_base.py:3734(median)
0,63.344,0,python3.9/site-packages/numpy/linalg/linalg.py:130(_realType)
1783,62.417,0.035,python3.9/site-packages/numpy/lib/function_base.py:3824(_median)
1745,57.585,0.033,<__array_function__ internals>:177(partition)
1745,57.582,0.033,python3.9/site-packages/numpy/core/fromnumeric.py:667(partition)
4352,56.576,0.013,<__array_function__ internals>:177(norm)
1792,53.775,0.03,{method 'partition' of 'numpy.ndarray' objects}
0,53.136,0,python3.9/site-packages/numpy/linalg/linalg.py:117(isComplexType)
4321,51.855,0.012,python3.9/site-packages/numpy/linalg/linalg.py:2357(norm)
0,43.799,0,python3.9/site-packages/numpy/core/getlimits.py:458(__new__)
1,43.09,43.09,coppafish/pipeline/stitch.py:9(stitch)
438,36.788,0.084,coppafish/omp/spots.py:72(cropped_coef_image)
1,30.204,30.204,coppafish/pipeline/call_reference_spots.py:12(call_reference_spots)
0,26.451,0,{built-in method builtins.issubclass}
25598,25.598,0.001,python3.9/site-packages/numpy/lib/arraypad.py:129(_set_pad_area)
2252,22.522,0.01,<__array_function__ internals>:177(argmax)
2251,22.512,0.01,python3.9/site-packages/numpy/core/fromnumeric.py:1127(argmax)
2500,22.502,0.009,{method 'argmax' of 'numpy.ndarray' objects}
0,22.41,0,{method 'squeeze' of 'numpy.ndarray' objects}
0,22.314,0,{method 'get' of 'dict' objects}
0,19.752,0,python3.9/site-packages/numpy/linalg/linalg.py:188(_assert_2d)
1,19.369,19.369,coppafish/pipeline/register.py:9(register)
0,19.31,0,{method '__array_prepare__' of 'numpy.ndarray' objects}
6435,19.305,0.003,<__array_function__ internals>:177(concatenate)
9,18.922,2.102,coppafish/setup/notebook.py:453(add_page)
9,18.922,2.102,coppafish/setup/notebook.py:474(__iadd__)
15,18.922,1.261,coppafish/setup/notebook.py:409(__setattr__)
8,18.92,2.365,coppafish/setup/notebook.py:534(save)
0,17.012,0,python3.9/site-packages/numpy/linalg/linalg.py:107(get_linalg_error_extobj)
40,16.388,0.41,python3.9/site-packages/numpy_indexed/arraysetops.py:115(indices)
0,16.314,0,{built-in method builtins.max}
1,16.056,16.056,coppafish/register/base.py:218(icp)
0,15.977,0,{built-in method builtins.getattr}
1310,15.721,0.012,coppafish/register/base.py:9(get_transform)
80,15.296,0.191,python3.9/site-packages/numpy_indexed/index.py:288(as_index)
80,15.296,0.191,python3.9/site-packages/numpy_indexed/index.py:173(__init__)
80,15.292,0.191,python3.9/site-packages/numpy_indexed/index.py:112(__init__)
1257,15.089,0.012,<__array_function__ internals>:177(append)
1257,15.086,0.012,python3.9/site-packages/numpy/lib/function_base.py:5389(append)
90,15.085,0.168,<__array_function__ internals>:177(argsort)
90,15.085,0.168,python3.9/site-packages/numpy/core/fromnumeric.py:1012(argsort)
94,15.084,0.16,{method 'argsort' of 'numpy.ndarray' objects}
377,13.956,0.037,python3.9/site-packages/numpy/lib/format.py:697(read_array)
206,13.795,0.067,{built-in method numpy.fromfile}
0,13.199,0,{built-in method numpy.asarray}
0,11.557,0,{method 'read' of '_io.BufferedReader' objects}
201,10.832,0.054,coppafish/spot_colors/base.py:163(all_pixel_yxz)
5,9.599,1.92,coppafish/utils/raw.py:75(load)
4,9.412,2.353,coppafish/utils/nd2.py:179(get_image)
0,9.28,0,python3.9/site-packages/numpy/linalg/linalg.py:2161(_lstsq_dispatcher)
0,8.056,0,{method 'reshape' of 'numpy.ndarray' objects}
2587,7.761,0.003,{method 'any' of 'numpy.ndarray' objects}
3878,7.756,0.002,python3.9/site-packages/numpy/core/_methods.py:54(_any)
201,7.634,0.038,python3.9/site-packages/slicerator/__init__.py:183(__getitem__)
201,7.626,0.038,python3.9/site-packages/pims/base_frames.py:97(__getitem__)
201,7.625,0.038,python3.9/site-packages/pims/base_frames.py:577(get_frame)
200,7.614,0.038,python3.9/site-packages/nd2reader/parser.py:81(get_image_by_attributes)
200,7.614,0.038,python3.9/site-packages/nd2reader/reader.py:72(get_frame_2D)
203,7.298,0.036,python3.9/site-packages/nd2reader/parser.py:249(_get_raw_image_data)
575,6.898,0.012,<__array_function__ internals>:177(any)
574,6.894,0.012,python3.9/site-packages/numpy/core/fromnumeric.py:2307(any)
3444,6.888,0.002,{method 'repeat' of 'numpy.ndarray' objects}
628,6.285,0.01,python3.9/site-packages/scipy/sparse/_csr.py:326(_get_arrayXslice)
2089,6.266,0.003,<__array_function__ internals>:177(tile)
626,6.262,0.01,python3.9/site-packages/scipy/sparse/_compressed.py:688(_major_index_fancy)
2086,6.259,0.003,python3.9/site-packages/numpy/lib/shape_base.py:1191(tile)
608,6.081,0.01,python3.9/site-packages/scipy/sparse/_base.py:837(nonzero)
5893,5.893,0.001,{method 'copy' of 'numpy.ndarray' objects}
611,5.499,0.009,python3.9/site-packages/scipy/sparse/_compressed.py:1034(tocoo)
635,5.08,0.008,{built-in method scipy.sparse._sparsetools.expandptr}
200,5.01,0.025,python3.9/site-packages/scipy/sparse/_construct.py:522(vstack)
200,5.009,0.025,python3.9/site-packages/scipy/sparse/_construct.py:556(bmat)
200,5.006,0.025,python3.9/site-packages/scipy/sparse/_construct.py:405(_compressed_sparse_stack)
0,4.781,0,{method 'min' of 'numpy.ndarray' objects}
357,4.638,0.013,coppafish/omp/spots.py:53(<listcomp>)
0,4.439,0,python3.9/site-packages/numpy/core/_methods.py:42(_amin)
0,4.301,0,coppafish/stitch/shift.py:10(shift_score)
200,4.206,0.021,python3.9/site-packages/scipy/sparse/_data.py:294(max)
200,4.205,0.021,python3.9/site-packages/scipy/sparse/_data.py:191(_min_or_max)
199,4.178,0.021,python3.9/site-packages/scipy/sparse/_data.py:163(_min_or_max_axis)
0,3.719,0,{method 'max' of 'numpy.ndarray' objects}
0,3.712,0,python3.9/site-packages/numpy/core/_methods.py:38(_amax)
685,3.427,0.005,{built-in method scipy.sparse._sparsetools.csr_row_index}
1536,3.071,0.002,python3.9/site-packages/numpy/lib/utils.py:1011(_median_nancheck)
264,2.899,0.011,coppafish/find_spots/base.py:7(spot_yxz)
2634,2.634,0.001,{method 'take' of 'numpy.ndarray' objects}
0,2.494,0,python3.9/site-packages/numpy/lib/format.py:568(_read_array_header)
0,2.341,0,python3.9/site-packages/tqdm/std.py:1339(refresh)
200,2.201,0.011,python3.9/site-packages/scipy/sparse/_compressed.py:628(_minor_reduce)
73,2.117,0.029,coppafish/utils/spot_images.py:7(get_spot_images)
235,2.113,0.009,python3.9/site-packages/nd2reader/common.py:47(read_chunk)
0,2.102,0,python3.9/site-packages/tqdm/std.py:1478(display)
406,2.031,0.005,python3.9/site-packages/scipy/sparse/_coo.py:371(tocsr)
81,2.015,0.025,<__array_function__ internals>:177(nan_to_num)
83,1.984,0.024,python3.9/site-packages/numpy/lib/type_check.py:404(nan_to_num)
203,1.828,0.009,python3.9/site-packages/nd2reader/stitched.py:6(get_unwanted_bytes_ids)
203,1.828,0.009,python3.9/site-packages/nd2reader/stitched.py:39(remove_parsed_unwanted_bytes)
194,1.742,0.009,python3.9/site-packages/scipy/sparse/_base.py:431(__gt__)
0,1.731,0,python3.9/site-packages/tqdm/std.py:1212(update)
0,1.728,0,<__array_function__ internals>:177(mean)
0,1.724,0,python3.9/site-packages/numpy/core/fromnumeric.py:3313(mean)
0,1.721,0,python3.9/site-packages/numpy/core/_methods.py:163(_mean)
6,1.681,0.28,<frozen importlib._bootstrap>:967(_find_and_load_unlocked)
6,1.681,0.28,<frozen importlib._bootstrap>:1002(_find_and_load)
6,1.68,0.28,<frozen importlib._bootstrap>:659(_load_unlocked)
4,1.679,0.42,<frozen importlib._bootstrap_external>:844(exec_module)
8,1.677,0.21,<frozen importlib._bootstrap>:220(_call_with_frames_removed)
0,1.673,0,python3.9/site-packages/numpy/lib/format.py:533(_filter_header)
1,1.673,1.673,coppafish/__init__.py:1(<module>)
0,1.668,0,{built-in method numpy.array}
36,1.618,0.045,{built-in method builtins.__import__}
404,1.617,0.004,{built-in method scipy.sparse._sparsetools.coo_tocsr}
0,1.613,0,{built-in method numpy.zeros}
401,1.603,0.004,<frozen importlib._bootstrap>:1033(_handle_fromlist)
312,1.56,0.005,<__array_function__ internals>:177(meshgrid)
312,1.559,0.005,python3.9/site-packages/numpy/lib/function_base.py:4846(meshgrid)
308,1.539,0.005,python3.9/site-packages/numpy/lib/function_base.py:4990(<listcomp>)
0,1.521,0,{built-in method io.open}
732,1.465,0.002,python3.9/site-packages/scipy/sparse/_compressed.py:1081(__get_has_canonical_format)
732,1.465,0.002,python3.9/site-packages/scipy/sparse/_compressed.py:1111(sum_duplicates)
730,1.459,0.002,{built-in method scipy.sparse._sparsetools.csr_has_canonical_format}
159,1.429,0.009,python3.9/site-packages/numpy/lib/ufunclike.py:48(func)
197,1.181,0.006,coppafish/find_spots/base.py:99(get_isolated_points)
0,1.173,0,python3.9/site-packages/tqdm/std.py:1164(__str__)
0,1.152,0,python3.9/tokenize.py:429(_tokenize)
0,1.139,0,python3.9/site-packages/tqdm/std.py:1416(set_postfix)
282,1.13,0.004,<__array_function__ internals>:177(flatnonzero)
282,1.129,0.004,python3.9/site-packages/numpy/core/numeric.py:631(flatnonzero)
282,1.127,0.004,python3.9/site-packages/numpy/core/fromnumeric.py:1866(nonzero)
282,1.127,0.004,<__array_function__ internals>:177(nonzero)
57,1.081,0.019,{method 'searchsorted' of 'numpy.ndarray' objects}
57,1.081,0.019,<__array_function__ internals>:177(searchsorted)
57,1.081,0.019,python3.9/site-packages/numpy/core/fromnumeric.py:1319(searchsorted)
350,1.051,0.003,<__array_function__ internals>:177(all)
350,1.05,0.003,python3.9/site-packages/numpy/core/fromnumeric.py:2406(all)